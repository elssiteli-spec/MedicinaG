# CMedicas - Sistema de Gesti√≥n de Citas M√©dicas

Sistema integral de gesti√≥n de citas m√©dicas desarrollado con React, TypeScript y Supabase, aplicando principios de HCI (Human-Computer Interaction) y dise√±o centrado en el usuario.

## üè• Caracter√≠sticas Principales

### ‚ú® Funcionalidades Core
- **Registro de Pacientes**: Sistema completo para registrar y gestionar pacientes
- **Gesti√≥n de M√©dicos**: Administraci√≥n de perfiles m√©dicos con especialidades
- **Gesti√≥n de Citas**: Sistema de agendamiento con validaci√≥n de disponibilidad
- **Dashboard Inteligente**: M√©tricas y estad√≠sticas en tiempo real
- **Reportes Avanzados**: Visualizaciones con gr√°ficos de barras y circulares
- **Base de Datos en la Nube**: Supabase (PostgreSQL) con Row Level Security

### ‚ôø Accesibilidad y Usabilidad
- **Panel de Accesibilidad**: Configuraciones personalizables (contraste, tama√±o de fuente, movimiento)
- **Navegaci√≥n por Teclado**: Soporte completo para usuarios con discapacidades motoras
- **Lectores de Pantalla**: Optimizado para NVDA, JAWS y VoiceOver
- **Dise√±o Responsive**: Adaptaci√≥n completa a m√≥viles, tablets y desktop
- **Cumplimiento WCAG 2.1 AA**: Est√°ndares internacionales de accesibilidad

### üé® Principios de HCI Aplicados
- **Visibilidad del Estado**: Feedback constante al usuario
- **Correspondencia con el Mundo Real**: Terminolog√≠a m√©dica familiar
- **Control del Usuario**: Navegaci√≥n reversible y cancelaci√≥n de acciones
- **Consistencia**: Patrones de dise√±o uniformes
- **Prevenci√≥n de Errores**: Validaciones y confirmaciones

## üõ†Ô∏è Tecnolog√≠as Utilizadas

### Frontend
- **React 18** con TypeScript
- **Tailwind CSS** para estilos
- **Lucide React** para iconograf√≠a
- **Vite** como bundler
- **Context API** para gesti√≥n de estado

### Backend
- **Supabase** (PostgreSQL en la nube)
- **Row Level Security (RLS)** para control de acceso
- **@supabase/supabase-js** cliente oficial
- **Edge Functions** para l√≥gica del lado del servidor (opcional)

### Base de Datos
- **PostgreSQL** a trav√©s de Supabase
- **3 Tablas Principales**: usuarios, m√©dicos, citas
- **15 Pol√≠ticas RLS** para seguridad
- **8 √çndices** para optimizaci√≥n de consultas

## üöÄ Instalaci√≥n y Configuraci√≥n

### Prerrequisitos
- Node.js 18+
- npm o yarn
- Cuenta de Supabase (gratuita)

### Instalaci√≥n

```bash
# Clonar el repositorio
git clone [repository-url]
cd cmedicas

# Instalar dependencias
npm install

# Configurar variables de entorno
# Crear archivo .env en la ra√≠z con:
VITE_SUPABASE_URL=tu_url_de_supabase
VITE_SUPABASE_ANON_KEY=tu_clave_anonima
```

### Configuraci√≥n de Supabase

1. **Crear Proyecto en Supabase**
   - Ve a [supabase.com](https://supabase.com)
   - Crea un nuevo proyecto
   - Copia la URL y la clave an√≥nima

2. **Ejecutar Migraci√≥n**
   - La migraci√≥n se encuentra en `supabase/migrations/`
   - La base de datos se crea autom√°ticamente al iniciar la app
   - Incluye 3 tablas, RLS y pol√≠ticas de seguridad

3. **Datos de Ejemplo**
   - 10 usuarios: 5 m√©dicos + 5 pacientes
   - 5 perfiles de m√©dicos con especialidades
   - 5 citas de ejemplo (programadas y completadas)

### Desarrollo

```bash
# Ejecutar en modo desarrollo
npm run dev

# La aplicaci√≥n se abrir√° en http://localhost:5173
```

### Producci√≥n

```bash
# Construir aplicaci√≥n
npm run build

# Preview de producci√≥n
npm run preview
```

## üìä Estructura de la Base de Datos

### Tablas Principales

#### 1. Tabla `usuarios`
Almacena todos los usuarios del sistema (pacientes, m√©dicos, personal administrativo).

**Campos:**
- `id` (uuid, PK): Identificador √∫nico
- `nombre` (text): Nombre completo
- `email` (text, UNIQUE): Correo electr√≥nico
- `password_hash` (text): Contrase√±a hasheada
- `fecha_nacimiento` (date): Fecha de nacimiento
- `direccion` (text): Direcci√≥n f√≠sica
- `telefono` (text): Tel√©fono principal
- `telefono_emergencia` (text): Contacto de emergencia
- `sexo` (text): masculino, femenino, otro
- `discapacidad` (text): Informaci√≥n de discapacidad
- `estado_civil` (text): soltero, casado, divorciado, viudo, union_libre
- `rol` (text): administrador, medico_especialista, enfermero, paciente, etc.
- `departamento` (text): Departamento de trabajo
- `activo` (boolean): Estado de cuenta
- `fecha_registro` (timestamptz): Fecha de registro

**Roles Disponibles:**
- administrador
- medico_especialista
- enfermero
- auxiliar_enfermeria
- pasante
- paramedico
- paciente
- seguridad
- persona_vulnerable

#### 2. Tabla `medicos`
Perfil extendido para profesionales m√©dicos.

**Campos:**
- `id` (uuid, PK): Identificador √∫nico
- `usuario_id` (uuid, FK): Referencia a usuarios
- `especialidad` (text): Especialidad m√©dica
- `cedula` (text, UNIQUE): C√©dula profesional
- `experiencia_anos` (integer): A√±os de experiencia
- `horario_atencion` (jsonb): Horario en formato JSON
- `consultorio` (text): N√∫mero de consultorio
- `calificacion` (numeric): Calificaci√≥n 0-5
- `total_consultas` (integer): Total de consultas
- `activo` (boolean): Estado activo
- `fecha_registro` (timestamptz): Fecha de registro

**Especialidades:**
- Cardiolog√≠a, Neurolog√≠a, Pediatr√≠a, Dermatolog√≠a
- Traumatolog√≠a, Oftalmolog√≠a, Psiquiatr√≠a
- Ginecolog√≠a, Endocrinolog√≠a, Urolog√≠a, Oncolog√≠a

#### 3. Tabla `citas`
Gesti√≥n de citas m√©dicas.

**Campos:**
- `id` (uuid, PK): Identificador √∫nico
- `paciente_id` (uuid, FK): ID del paciente
- `medico_id` (uuid, FK): ID del m√©dico
- `fecha` (date): Fecha de la cita
- `hora` (time): Hora de la cita
- `especialidad` (text): Especialidad m√©dica
- `estado` (text): programada, completada, cancelada, no_asistio
- `motivo` (text): Motivo de consulta
- `observaciones` (text): Notas adicionales
- `fecha_creacion` (timestamptz): Fecha de creaci√≥n
- `fecha_actualizacion` (timestamptz): √öltima actualizaci√≥n

### Relaciones

```
usuarios (1) ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ (1) medicos
    ‚Üì
    ‚îî‚îÄ‚Üí (N) citas ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ medicos (1)
```

**Relaci√≥n 1:** usuarios ‚Üí medicos (1:1)
- Cada m√©dico es un usuario
- ON DELETE CASCADE

**Relaci√≥n 2:** usuarios ‚Üí citas (1:N)
- Un paciente puede tener m√∫ltiples citas
- ON DELETE CASCADE

**Relaci√≥n 3:** medicos ‚Üí citas (1:N)
- Un m√©dico puede tener m√∫ltiples citas
- ON DELETE CASCADE

### Seguridad: Row Level Security (RLS)

Todas las tablas tienen RLS habilitado con pol√≠ticas espec√≠ficas:

**Usuarios:**
- Los usuarios pueden ver su propio perfil
- Los administradores ven todos los usuarios
- Registro p√∫blico permitido

**M√©dicos:**
- Usuarios autenticados ven m√©dicos activos
- M√©dicos ven su propio perfil
- Administradores tienen acceso completo

**Citas:**
- Pacientes ven sus propias citas
- M√©dicos ven citas asignadas a ellos
- Administradores ven todas las citas
- Solo administradores pueden eliminar citas

## üéØ Servicios de Base de Datos

### `usuariosService`
```typescript
- getAll(): Promise<Usuario[]>
- getById(id): Promise<Usuario | null>
- getByEmail(email): Promise<Usuario | null>
- getByRole(rol): Promise<Usuario[]>
- create(usuario): Promise<Usuario>
- update(id, updates): Promise<Usuario>
- delete(id): Promise<void>
```

### `medicosService`
```typescript
- getAll(): Promise<MedicoConUsuario[]>
- getById(id): Promise<MedicoConUsuario | null>
- getByUsuarioId(usuarioId): Promise<MedicoConUsuario | null>
- getByEspecialidad(especialidad): Promise<MedicoConUsuario[]>
- create(medico): Promise<MedicoConUsuario>
- update(id, updates): Promise<MedicoConUsuario>
- delete(id): Promise<void>
```

### `citasService`
```typescript
- getAll(): Promise<CitaDetallada[]>
- getById(id): Promise<CitaDetallada | null>
- getByPaciente(pacienteId): Promise<CitaDetallada[]>
- getByMedico(medicoId): Promise<CitaDetallada[]>
- getByFecha(fecha): Promise<CitaDetallada[]>
- getByEstado(estado): Promise<CitaDetallada[]>
- create(cita): Promise<CitaDetallada>
- update(id, updates): Promise<CitaDetallada>
- delete(id): Promise<void>
```

### `estadisticasService`
```typescript
- getCitasPorEspecialidad(): Promise<Array>
- getCitasPorEstado(): Promise<Record>
- getTotalPacientesActivos(): Promise<number>
- getTotalCitas(): Promise<number>
```

## üé® Caracter√≠sticas de Dise√±o

### Sistema de Colores
- **Primario**: Azul m√©dico (#3B82F6)
- **Secundario**: Verde salud (#10B981)
- **Acentos**: Naranja (#F59E0B), Rojo (#EF4444)
- **Neutros**: Escala de grises completa
- **Alto Contraste**: Modo alternativo para accesibilidad

### Tipograf√≠a
- **Fuente**: System fonts (Inter, SF Pro, Segoe UI)
- **Escalas**: 4 tama√±os configurables
- **Pesos**: Regular (400), Medium (500), Semibold (600), Bold (700)
- **Line Height**: 150% para cuerpo, 120% para t√≠tulos

### Componentes
- **Botones**: Estados hover, focus, disabled
- **Formularios**: Validaci√≥n en tiempo real
- **Modales**: Responsive con escape key
- **Tablas**: Scrollables con sticky headers
- **Cards**: Sombras sutiles y hover effects

## üì± Responsive Design

### Breakpoints
- **Mobile**: < 640px
- **Tablet**: 640px - 1024px
- **Desktop**: > 1024px

### Adaptaciones
- **Sidebar**: Colapsible en m√≥vil
- **Tablas**: Scroll horizontal
- **Formularios**: Stack vertical en m√≥vil
- **Modales**: Full screen en m√≥vil

## üß™ Testing y Calidad

### Validaciones Implementadas
- **Formularios**: Validaci√≥n client-side y server-side
- **Fechas**: Validaci√≥n de rangos y disponibilidad
- **Emails**: Formato y unicidad
- **Datos**: Check constraints en base de datos

### Manejo de Errores
- **Frontend**: Mensajes claros y estados de error
- **Backend**: RLS autom√°tico y respuestas consistentes
- **Base de Datos**: Constraints y validaciones

## üîß Estructura del Proyecto

```
cmedicas/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/          # Componentes React
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Accessibility/   # Panel de accesibilidad
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AppointmentManagement/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Auth/           # Login y registro
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dashboard/      # Panel principal
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DatabaseStatus/ # Estado de conexi√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DoctorManagement/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Layout/         # Header y Sidebar
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Reports/        # Reportes y gr√°ficos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UserManagement/ # Registro de pacientes
‚îÇ   ‚îú‚îÄ‚îÄ contexts/           # Context providers
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AuthContext.tsx
‚îÇ   ‚îú‚îÄ‚îÄ lib/                # Configuraci√≥n
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ supabase.ts     # Cliente Supabase
‚îÇ   ‚îú‚îÄ‚îÄ services/           # Servicios de datos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ database.ts     # CRUD completo
‚îÇ   ‚îú‚îÄ‚îÄ types/              # Definiciones TypeScript
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îî‚îÄ‚îÄ utils/              # Utilidades
‚îú‚îÄ‚îÄ supabase/
‚îÇ   ‚îî‚îÄ‚îÄ migrations/         # Migraciones SQL
‚îÇ       ‚îî‚îÄ‚îÄ create_cmedicas_schema.sql
‚îú‚îÄ‚îÄ docs/                   # Documentaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ INFORME_PROYECTO_CMEDICAS.md
‚îÇ   ‚îú‚îÄ‚îÄ DIAGRAMA_ENTIDAD_RELACION.md
‚îÇ   ‚îú‚îÄ‚îÄ analisis-usuario.md
‚îÇ   ‚îú‚îÄ‚îÄ diseno-interfaces.md
‚îÇ   ‚îî‚îÄ‚îÄ tipos-diseno.md
‚îî‚îÄ‚îÄ dist/                   # Build de producci√≥n
```

## üìà M√©tricas y Dashboard

### Tarjetas Estad√≠sticas
- **Total de Citas**: Con tendencia de crecimiento
- **Pacientes Activos**: Contador en tiempo real
- **Tasa de Asistencia**: Porcentaje de citas completadas
- **Tiempo Promedio**: Duraci√≥n de consultas

### Visualizaciones
1. **Gr√°fico de Barras**: Citas por especialidad
2. **Gr√°fico Circular**: Distribuci√≥n por estado
3. **Tendencia Mensual**: Evoluci√≥n de citas
4. **Top M√©dicos**: Ranking de m√°s solicitados
5. **Actividad Reciente**: Feed de eventos en tiempo real

## üîê Seguridad

### Medidas Implementadas
1. **Row Level Security (RLS)**: Control de acceso a nivel de fila
2. **Pol√≠ticas Granulares**: 15 pol√≠ticas espec√≠ficas por operaci√≥n
3. **√çndices Optimizados**: 8 √≠ndices para rendimiento
4. **Foreign Keys**: Integridad referencial garantizada
5. **Check Constraints**: Validaci√≥n de datos en BD
6. **Hash de Contrase√±as**: Nunca se almacenan en texto plano

### Mejores Pr√°cticas
- Usar siempre los servicios proporcionados
- Validar datos en frontend antes de enviar
- Manejar errores apropiadamente
- Verificar permisos antes de operaciones sensibles
- Usar `maybeSingle()` en lugar de `single()`

## üìÑ Documentaci√≥n Adicional

### Archivos Incluidos
- **INFORME_PROYECTO_CMEDICAS.md**: Informe completo del proyecto
- **DIAGRAMA_ENTIDAD_RELACION.md**: Diagrama ER visual detallado
- **DATABASE_README.md**: Gu√≠a de base de datos (si existe)
- **analisis-usuario.md**: An√°lisis de usuarios
- **diseno-interfaces.md**: Especificaciones de dise√±o
- **tipos-diseno.md**: Tipos de dise√±o aplicados

### Scripts SQL √ötiles

**Verificar Totales:**
```sql
SELECT
  (SELECT COUNT(*) FROM usuarios) as total_usuarios,
  (SELECT COUNT(*) FROM medicos) as total_medicos,
  (SELECT COUNT(*) FROM citas) as total_citas;
```

**Listar Citas Completas:**
```sql
SELECT
  c.fecha, c.hora,
  p.nombre as paciente,
  d.nombre as doctor,
  c.especialidad, c.estado, c.motivo
FROM citas c
JOIN usuarios p ON c.paciente_id = p.id
JOIN medicos m ON c.medico_id = m.id
JOIN usuarios d ON m.usuario_id = d.id
ORDER BY c.fecha, c.hora;
```

## üöÄ Despliegue

### Build de Producci√≥n
```bash
npm run build
```

### Deploy a Netlify/Vercel
1. Conectar repositorio
2. Configurar variables de entorno:
   - `VITE_SUPABASE_URL`
   - `VITE_SUPABASE_ANON_KEY`
3. Build command: `npm run build`
4. Publish directory: `dist`

## ü§ù Contribuci√≥n

### Est√°ndares de C√≥digo
- **ESLint**: Configuraci√≥n estricta
- **TypeScript**: Tipado fuerte
- **Prettier**: Formateo autom√°tico (si configurado)
- **Commits**: Descriptivos y claros

## üìû Soporte y Contacto

Para preguntas, sugerencias o reportar problemas:
- Crear un issue en el repositorio
- Consultar la documentaci√≥n en `/docs`

## üìÑ Licencia

Este proyecto est√° bajo la Licencia MIT. Ver `LICENSE` para m√°s detalles.

## üë• Cr√©ditos

Desarrollado como proyecto acad√©mico aplicando principios de HCI, dise√±o centrado en el usuario y mejores pr√°cticas de desarrollo web para sistemas de salud.

---

**CMedicas** - Sistema de Gesti√≥n M√©dica con Enfoque en Accesibilidad, Seguridad y Usabilidad

**Versi√≥n:** 1.0.0
**√öltima Actualizaci√≥n:** Octubre 2025
**Base de Datos:** Supabase (PostgreSQL)
**Frontend:** React 18 + TypeScript + Vite
**Estilos:** Tailwind CSS
